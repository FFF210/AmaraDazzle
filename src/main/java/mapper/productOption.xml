<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.productOption">
	<!-- =====================소비자용======================== -->
	<!-- 상품 ID로 해당 상품의 옵션 목록 조회: 상세 페이지에서 옵션 드롭다운 보여줄 때 -->
	<select id="selectProductOptionsByProductId"
		parameterType="Long" resultType="dto.ProductOption">
		SELECT * FROM product_option
		WHERE
		product_id = #{productId}
		ORDER BY product_option_id
	</select>

	<!-- =======[소비자용] 주문 결제 페이지(checkout)에서 각 옵션의 상세 정보 조회용 ====== -->
	<select id="selectProductOptionByOptionId" parameterType="Long"
		resultType="dto.ProductOption">
		SELECT
		product_option_id AS productOptionId,
		product_id AS
		productId,
		option_value AS optionValue,
		price,
		stock_qty AS stockQty,
		created_at AS createdAt,
		updated_at AS updatedAt
		FROM product_option
		WHERE product_option_id = #{optionId}
	</select>

	<!-- ========== [소비자] 상품의 전체 옵션 목록 조회 (교환신청용) ====== -->
	<select id="getProductOptions" parameterType="Long"
		resultType="map">
		SELECT
		po.product_option_id as optionId,
		po.option_value as
		optionValue,
		po.price as optionPrice,
		po.stock_qty as stockQty
		FROM
		product_option po
		WHERE po.product_id = #{productId}
		AND po.stock_qty >
		0
		ORDER BY po.option_value
	</select>

	<!--======================= [브랜드 어드민] 옵션 등록 ======================= -->
	<insert id="insertOption" parameterType="productOption">
		INSERT INTO
		product_option (product_id, option_value, price, stock_qty)
		VALUES
		(#{productId}, #{optionValue}, #{price}, #{stockQty})
	</insert>

	<!--======================= [브랜드 어드민] 특정 상품 옵션 목록 ======================= -->
	<select id="selectOptionsByProductId" parameterType="string"
		resultType="productOption">
		SELECT product_option_id, product_id, option_value, price,
		stock_qty,
		created_at, updated_at
		FROM product_option
		WHERE product_id =
		#{productId}
		ORDER BY product_option_id DESC
	</select>

	<!--======================= [브랜드 어드민] 옵션 삭제 ======================= -->
	<delete id="deleteOption" parameterType="long">
		DELETE FROM
		product_option
		WHERE product_id = #{productId}
	</delete>


</mapper>