<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.brandFollow">

	<!-- ================[소비자] 브랜드 팔로우 =================== -->
	<insert id="insertBrandFollow" parameterType="map">
		INSERT INTO brand_follow
		(member_id, brand_id)
		VALUES (#{memberId}, #{brandId})
	</insert>

	<!-- ================[소비자] 이미 팔로우한 브랜드인지 확인 =================== -->
	<select id="existsBrandFollow" parameterType="map"
		resultType="Integer">
		SELECT COUNT(*)
		FROM brand_follow
		WHERE member_id = #{memberId}
		AND brand_id = #{brandId}
	</select>

	<!-- ================[소비자] 브랜드 팔로우 취소 =================== -->
	<delete id="deleteBrandFollow" parameterType="map">
		DELETE FROM brand_follow
		WHERE member_id = #{memberId} AND brand_id = #{brandId}
	</delete>

	<!-- ================[소비자] 팔로우 브랜드 목록 조회 =================== -->
	<select id="selectBrandFollowByMemberId" parameterType="Long"
		resultType="map">
		SELECT
		bf.brand_follow_id as brandFollowId,
		bf.member_id as memberId,
		bf.brand_id as brandId,
		bf.created_at as createdAt,
		b.brand_name as brandName,
		b.brand_logo as brandLogo,
		b.description as description
		FROM brand_follow bf
		LEFT JOIN brand b ON bf.brand_id = b.brand_id
		WHERE bf.member_id = #{memberId}
		ORDER BY bf.created_at DESC
	</select>

	<!-- ================[소비자] 팔로우 브랜드 개수 조회 =================== -->
	<select id="countBrandFollowByMemberId" parameterType="Long"
		resultType="int">
		SELECT COUNT(*)
		FROM brand_follow
		WHERE member_id = #{memberId}
	</select>
</mapper>